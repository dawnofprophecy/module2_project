version: 2
models:
  - name: fct_order_item
    columns:
      - name: order_item_key
        tests: [unique, not_null]
      - name: product_key
        tests:
          - relationships:
              to: ref('dim_product')
              field: product_key
      - name: seller_key
        tests:
          - relationships:
              to: ref('dim_seller')
              field: seller_key
      - name: customer_key
        tests:
          - relationships:
              to: ref('dim_customer')
              field: customer_key
      - name: late_delivery_flag
        tests:
          - dbt_expectations.expect_column_values_to_be_in_set:
              value_set: [0,1]
              quote_values: false
              row_condition: "late_delivery_flag is not null"

  - name: fct_payment
    columns:
      - name: payment_row_key
        tests: [unique, not_null]

  - name: fct_review
    columns:
      - name: review_key
        tests: [unique, not_null]
